{
  "fileTypes": ["wly"],
  "name": "Writerly",
  "scopeName": "source.writerly",
  "patterns": [
    {
      "include": "#comment"
    },
    {
      "include": "#block-with-attributes"
    },
    {
      "include": "#codeblock"
    }
  ],
  "repository": {
    "comment": {
      "patterns": [
        {
          "captures": {
            "1": {
              "name": "punctuation.definition.comment.mark"
            }
          },
          "begin": "^ *!!",
          "end": "$",
          "name": "comment.line.mark"
        }
      ]
    },
    "block-with-attributes": {
      "begin": "^( *)(\\|\\>?)( *)(|(?:.*[^ ]))( *)$",
      "beginCaptures": {
        "1": {
          "name": "punctuation.whitespace.leading"
        },
        "2": {
          "name": "punctuation.whitespace"
        },
        "3": {
          "name": "punctuation.definition.tag"
        },
        "4": {
          "name": "entity.name.tag"
        },
        "5": {
          "name": "punctuation.whitespace"
        }
      },
      "end": "^(?!(\\1    ([a-zA-Z_][-a-zA-Z0-9\\._\\:]*)=(.*)$)|(\\1    !!(.*)$))",
      "patterns": [
        {
          "include": "#comment"
        },
        {
          "include": "#attributes"
        }
      ]
    },
    "attributes": {
      "patterns": [
        {
          "match": "(?: *)([a-zA-Z_][-a-zA-Z0-9\\._\\:]*)(=)(.*)$",
          "captures": {
            "1": {
              "name": "text.html entity.other.attribute-name"
            },
            "2": {
              "name": "punctuation.separator.key-value.wly"
            },
            "3": {
              "name": "text string string.unquoted string.unquoted.html"
            }
          }
        }
      ]
    },
    "codeblock": {
      "begin": "^( *)(```)(.*)$",
      "beginCaptures": {
        "1": {
          "name": "punctuation.whitespace.leading"
        },
        "2": {
          "name": "markup.fenced_code punctuation.definition.markdown"
        },
        "3": {
          "name": "fenced_code.block.language"
        }
      },
      "end": "^(\\1)(```)( *)$",
      "endCaptures": {
        "1": {
          "name": "punctuation.whitespace.leading"
        },
        "2": {
          "name": "markup.fenced_code punctuation.definition.markdown"
        }
      },
      "contentName": "text markup.raw.block markup.fenced_code.block.markdown"
    }
  }
}
